<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Destination Send Workflow • projr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Destination Send Workflow">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">projr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/get-started.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/how-to-guides.html">How-to guides</a></li>
    <li><a class="dropdown-item" href="../articles/build-process.html">Build Process</a></li>
    <li><a class="dropdown-item" href="../articles/send-to-remotes.html">Sending to Remotes</a></li>
    <li><a class="dropdown-item" href="../articles/dest-send-workflow.html">Destination Send Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/restore-artifacts.html">Restoring Artifacts</a></li>
    <li><a class="dropdown-item" href="../articles/environment.html">Environment Variables</a></li>
    <li><a class="dropdown-item" href="../articles/scripts-and-hooks.html">Scripts and Hooks</a></li>
    <li><a class="dropdown-item" href="../articles/concepts.html">Concepts</a></li>
    <li><a class="dropdown-item" href="../articles/design.html">Design</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
    <li><a class="dropdown-item" href="../BUILDLOG.html">Build log</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SATVILab/projr" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Destination Send Workflow</h1>
            
      

      <div class="d-none name"><code>dest-send-workflow.Rmd</code></div>
    </div>

    
    
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
</script><p>This vignette explains the internal workflow for sending content to
remote destinations during builds. It describes the three main stages
that occur when projr uploads artifacts to GitHub releases, local
directories, or OSF nodes.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When you run a production build (<code><a href="../reference/projr_build.html">projr_build_patch()</a></code>,
<code><a href="../reference/projr_build.html">projr_build_minor()</a></code>, or <code><a href="../reference/projr_build.html">projr_build_major()</a></code>),
projr can automatically send artifacts to configured remote
destinations. This process is controlled by the
<code>.dest_send_label()</code> function in
<code>R/dest-send-label.R</code>, which orchestrates three distinct
stages:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Getting the Remotes</strong> - Resolve remote locations and
metadata</li>
<li>
<strong>Building the Plan</strong> - Determine which files need to
be added, removed, or updated</li>
<li>
<strong>Implementing the Plan</strong> - Execute the file operations
and update remote metadata</li>
</ol>
<p>Each stage builds upon the previous one to ensure efficient and
accurate synchronization between your local project and remote
destinations.</p>
</div>
<div class="section level2">
<h2 id="stage-1-getting-the-remotes">Stage 1: Getting the Remotes<a class="anchor" aria-label="anchor" href="#stage-1-getting-the-remotes"></a>
</h2>
<p>The first stage resolves remote locations and determines what
versions exist on the remote destination.</p>
<pre class="mermaid"><code>flowchart TD
    Start([Start: .dsl_get_remotes]) --&gt; GetPre[Get remote_pre&lt;br/&gt;Base remote location]
    GetPre --&gt; GetDestFull[Get remote_dest_full&lt;br/&gt;Full version destination]
    GetDestFull --&gt; GetDestEmpty[Get remote_dest_empty&lt;br/&gt;Empty version destination]
    GetDestEmpty --&gt; GetVersionComp[Determine version_comp&lt;br/&gt;Version to compare against]
    
    GetVersionComp --&gt; CheckInspect{inspect == 'none'?}
    CheckInspect --&gt;|Yes| ReturnNull[version_comp = NULL]
    CheckInspect --&gt;|No| CheckStructure{structure?}
    
    CheckStructure --&gt;|latest| LatestLogic[Check if remote exists&lt;br/&gt;Trust based on manifest]
    CheckStructure --&gt;|archive| ArchiveLogic[Find latest acceptable&lt;br/&gt;archive version]
    
    LatestLogic --&gt; GetComp[Get remote_comp&lt;br/&gt;Remote for comparison]
    ArchiveLogic --&gt; GetComp
    ReturnNull --&gt; GetComp
    
    GetComp --&gt; End([Return remote list])
    
    style Start fill:#e1f5e1
    style End fill:#e1f5e1
    style GetVersionComp fill:#fff4e1</code></pre>
<p><strong>Key Outputs:</strong></p>
<ul>
<li>
<code>remote_pre</code> - The base remote location (e.g., GitHub
release tag, local directory path)</li>
<li>
<code>remote_dest_full</code> - Where files will be uploaded (full
version, not empty)</li>
<li>
<code>remote_dest_empty</code> - Empty version variant (for GitHub
empty placeholders)</li>
<li>
<code>version_comp</code> - Version to compare against (NULL if no
trusted version available)</li>
<li>
<code>remote_comp</code> - The actual remote object used for
comparison</li>
</ul>
<p><strong>Version Comparison Logic:</strong></p>
<p>The <code>version_comp</code> determines which remote version can be
trusted for comparisons:</p>
<ul>
<li>
<strong>NULL</strong> - No trusted version available; treat remote
as empty (upload everything)</li>
<li>
<strong>Version string</strong> - Trusted version exists; compare
local files against this version</li>
</ul>
<p>For <code>latest</code> structure: - Uses the current remote contents
if they exist - Trusts manifest if available and valid</p>
<p>For <code>archive</code> structure: - Finds the latest archive
version that matches local state - Must be recent enough (no local
changes since that version) - For <code>inspect = "file"</code>, always
trusts the version by hashing files - For
<code>inspect = "manifest"</code>, only trusts if manifest is valid</p>
</div>
<div class="section level2">
<h2 id="stage-2-building-the-plan">Stage 2: Building the Plan<a class="anchor" aria-label="anchor" href="#stage-2-building-the-plan"></a>
</h2>
<p>The second stage compares local and remote state to determine which
files need to be uploaded, removed, or updated.</p>
<pre class="mermaid"><code>flowchart TD
    Start([Start: .dsl_get_plan]) --&gt; GetFilenames[Get file lists&lt;br/&gt;fn_source &amp; fn_dest]
    
    GetFilenames --&gt; Strategy{send_strategy?}
    
    Strategy --&gt;|upload-all| UploadAll[fn_add = all local files&lt;br/&gt;fn_rm = none]
    Strategy --&gt;|upload-missing| UploadMissing[fn_add = local files not on remote&lt;br/&gt;fn_rm = none]
    Strategy --&gt;|sync-diff| SyncDiff[Compare hashes&lt;br/&gt;fn_add = new + changed&lt;br/&gt;fn_rm = deleted]
    Strategy --&gt;|sync-purge| SyncPurge[Compare hashes&lt;br/&gt;fn_add = all local&lt;br/&gt;purge = true]
    
    UploadAll --&gt; BuildActions[Translate to actions]
    UploadMissing --&gt; BuildActions
    SyncDiff --&gt; BuildActions
    SyncPurge --&gt; BuildActions
    
    BuildActions --&gt; CheckCue{send_cue?}
    CheckCue --&gt;|never| SkipSend[Skip upload]
    CheckCue --&gt;|always| ProceedSend[Proceed with upload]
    CheckCue --&gt;|if-change| CheckChanges{Any changes?}
    
    CheckChanges --&gt;|Yes| ProceedSend
    CheckChanges --&gt;|No| SkipSend
    
    ProceedSend --&gt; BuildMetadata[Build metadata updates&lt;br/&gt;- manifest.csv&lt;br/&gt;- VERSION file&lt;br/&gt;- changelog]
    SkipSend --&gt; End
    BuildMetadata --&gt; End([Return plan])
    
    style Start fill:#e1f5e1
    style End fill:#e1f5e1
    style BuildActions fill:#fff4e1</code></pre>
<p><strong>Key Outputs:</strong></p>
<ul>
<li>
<code>fn_add</code> - Files to upload to the remote</li>
<li>
<code>fn_rm</code> - Files to remove from the remote</li>
<li>
<code>version</code> - Updated VERSION file content</li>
<li>
<code>manifest</code> - Updated manifest.csv content</li>
<li>
<code>purge</code> - Whether to purge all remote files before
upload</li>
<li>
<code>ensure_remote_dest_exists</code> - Whether to create the
remote if it doesn’t exist</li>
<li>
<code>is_remote_dest_empty</code> - Whether the remote will be empty
after operations</li>
</ul>
<p><strong>Send Strategies:</strong></p>
<p>Different strategies determine how local and remote files are
compared:</p>
<ul>
<li>
<strong>upload-all</strong> - Upload all local files, ignore remote
state</li>
<li>
<strong>upload-missing</strong> - Only upload files that don’t exist
on remote</li>
<li>
<strong>sync-diff</strong> - Upload new/changed files, remove
deleted files</li>
<li>
<strong>sync-purge</strong> - Remove all remote files, then upload
all local files</li>
</ul>
<p><strong>Inspection Modes:</strong></p>
<p>The <code>inspect</code> parameter controls how projr determines
what’s on the remote:</p>
<ul>
<li>
<strong>manifest</strong> - Use remote manifest.csv (fast, requires
valid manifest)</li>
<li>
<strong>file</strong> - Download and hash actual files (slower,
always accurate)</li>
<li>
<strong>none</strong> - Treat remote as empty (always upload
everything)</li>
</ul>
</div>
<div class="section level2">
<h2 id="stage-3-implementing-the-plan">Stage 3: Implementing the Plan<a class="anchor" aria-label="anchor" href="#stage-3-implementing-the-plan"></a>
</h2>
<p>The third stage executes the file operations and updates remote
metadata.</p>
<pre class="mermaid"><code>flowchart TD
    Start([Start: .dsl_implement_plan]) --&gt; CheckPurge{purge?}
    
    CheckPurge --&gt;|Yes| PurgeRemote[Remove all files&lt;br/&gt;from remote_dest_full]
    CheckPurge --&gt;|No| AddFiles
    
    PurgeRemote --&gt; AddFiles[Add files from fn_add]
    
    AddFiles --&gt; CheckAdd{fn_add empty?}
    CheckAdd --&gt;|No| CreateIfNeeded{remote exists?}
    CheckAdd --&gt;|Yes| RemoveFiles
    
    CreateIfNeeded --&gt;|No| CreateRemote[Create remote destination]
    CreateIfNeeded --&gt;|Yes| UploadFiles[Upload files to remote]
    
    CreateRemote --&gt; UploadFiles
    UploadFiles --&gt; RemoveFiles[Remove files from fn_rm]
    
    RemoveFiles --&gt; CheckRm{fn_rm empty?}
    CheckRm --&gt;|No| DeleteFiles[Delete files from remote]
    CheckRm --&gt;|Yes| FinalizeRemotes
    
    DeleteFiles --&gt; FinalizeRemotes[Finalize remote states&lt;br/&gt;- Remove empty variant if full exists&lt;br/&gt;- Create empty variant if needed]
    
    FinalizeRemotes --&gt; CheckBoth{Both full &amp; empty exist?}
    CheckBoth --&gt;|Yes| RemoveEmpty[Remove empty remote]
    CheckBoth --&gt;|No| CheckCreate{Create empty needed?}
    
    RemoveEmpty --&gt; UpdateMetadata
    CheckCreate --&gt;|Yes| CreateEmpty[Create empty remote]
    CheckCreate --&gt;|No| UpdateMetadata
    
    CreateEmpty --&gt; UpdateMetadata[Upload metadata files&lt;br/&gt;- manifest.csv&lt;br/&gt;- VERSION file&lt;br/&gt;- CHANGELOG.md]
    
    UpdateMetadata --&gt; End([Complete])
    
    style Start fill:#e1f5e1
    style End fill:#e1f5e1
    style FinalizeRemotes fill:#fff4e1</code></pre>
<p><strong>Key Operations:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Purge</strong> (if <code>purge = TRUE</code>) - Remove all
existing files from remote</li>
<li>
<strong>Add files</strong> - Upload files in <code>fn_add</code> to
remote destination</li>
<li>
<strong>Remove files</strong> - Delete files in <code>fn_rm</code>
from remote destination</li>
<li>
<strong>Finalize remotes</strong> - Handle empty/full remote
variants:
<ul>
<li>For GitHub: manages <code>-empty.zip</code> placeholder files</li>
<li>For local: manages empty version directories</li>
<li>Ensures only one variant exists (full takes priority)</li>
</ul>
</li>
<li>
<strong>Update metadata</strong> - Upload manifest.csv, VERSION
file, and optionally CHANGELOG.md</li>
</ol>
<p><strong>Remote Variants:</strong></p>
<p>For archive structures, projr manages two variants of each
version:</p>
<ul>
<li>
<strong>Full remote</strong> (<code>remote_dest_full</code>) -
Contains actual files (e.g., <code>output-v0.0.1.zip</code>)</li>
<li>
<strong>Empty remote</strong> (<code>remote_dest_empty</code>) -
Placeholder when no files exist (e.g.,
<code>output-v0.0.1-empty.zip</code>)</li>
</ul>
<p>This allows projr to distinguish between: - “Version never uploaded”
(neither variant exists) - “Version uploaded but empty” (empty variant
exists) - “Version uploaded with files” (full variant exists)</p>
<p>Only one variant exists at a time. When files are added to an empty
remote, the empty variant is deleted and the full variant is
created.</p>
</div>
<div class="section level2">
<h2 id="complete-workflow">Complete Workflow<a class="anchor" aria-label="anchor" href="#complete-workflow"></a>
</h2>
<p>Here’s how all three stages work together during a build:</p>
<pre class="mermaid"><code>flowchart TD
    Start([Production Build]) --&gt; Loop{For each&lt;br/&gt;destination}
    
    Loop --&gt; Stage1[Stage 1: Get Remotes&lt;br/&gt;.dsl_get_remotes]
    
    Stage1 --&gt; Stage2[Stage 2: Build Plan&lt;br/&gt;.dsl_get_plan]
    
    Stage2 --&gt; CheckCue{send_cue&lt;br/&gt;allows?}
    CheckCue --&gt;|No| Loop
    CheckCue --&gt;|Yes| Stage3[Stage 3: Implement Plan&lt;br/&gt;.dsl_implement_plan]
    
    Stage3 --&gt; Loop
    Loop --&gt; End([Build Complete])
    
    style Start fill:#e1f5e1
    style End fill:#e1f5e1
    style Stage1 fill:#e3f2fd
    style Stage2 fill:#fff9c4
    style Stage3 fill:#f3e5f5</code></pre>
<p><strong>Build Integration:</strong></p>
<p>The destination send process is triggered during post-build
operations:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Pre-build</strong> - Clear directories, hash input
files</li>
<li>
<strong>Build</strong> - Render documents and scripts</li>
<li>
<strong>Post-build</strong> - Hash output files, commit to git</li>
<li>
<strong>Destination Send</strong> - Upload to remotes (this
workflow)</li>
<li>
<strong>Dev Version Bump</strong> - Increment to next dev
version</li>
</ol>
<p>For each configured destination in <code>_projr.yml</code>: - Check
if <code>send_cue</code> condition is met (always, if-change, never) -
Get remotes and determine comparison version - Build upload/removal plan
based on <code>send_strategy</code> and <code>send_inspect</code> -
Execute plan if approved by cue logic</p>
</div>
<div class="section level2">
<h2 id="configuration-parameters">Configuration Parameters<a class="anchor" aria-label="anchor" href="#configuration-parameters"></a>
</h2>
<p>The workflow behavior is controlled by parameters in
<code>_projr.yml</code>:</p>
<p><strong>structure</strong> (where versions are stored): -
<code>archive</code> - Create separate versions (v0.0.1, v0.0.2, etc.) -
<code>latest</code> - Overwrite same location each time</p>
<p><strong>send_cue</strong> (when to upload): - <code>always</code> -
Upload every build - <code>if-change</code> - Only upload if content
changed - <code>never</code> - Skip upload</p>
<p><strong>send_strategy</strong> (how to upload): -
<code>sync-diff</code> - Upload changed/new files, remove deleted files
- <code>sync-purge</code> - Remove all, then upload all -
<code>upload-all</code> - Upload all files - <code>upload-missing</code>
- Only upload missing files</p>
<p><strong>send_inspect</strong> (how to check remote): -
<code>manifest</code> - Use manifest.csv (fast) - <code>file</code> -
Hash actual files (slower, accurate) - <code>none</code> - Treat as
empty (always upload)</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-first-upload-no-remote-exists">Example 1: First Upload (No Remote Exists)<a class="anchor" aria-label="anchor" href="#example-1-first-upload-no-remote-exists"></a>
</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> archive</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> if-change</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> sync-diff</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> manifest</span></span></code></pre></div>
<p><strong>Workflow:</strong> 1. <strong>Get Remotes</strong>:
<code>version_comp = NULL</code> (no remote exists) 2. <strong>Build
Plan</strong>: <code>fn_add = all local files</code>,
<code>fn_rm = []</code> 3. <strong>Implement</strong>: Create remote,
upload all files, write manifest</p>
</div>
<div class="section level3">
<h3 id="example-2-incremental-update-files-changed">Example 2: Incremental Update (Files Changed)<a class="anchor" aria-label="anchor" href="#example-2-incremental-update-files-changed"></a>
</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> archive</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> if-change</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> sync-diff</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> manifest</span></span></code></pre></div>
<p><strong>Workflow:</strong> 1. <strong>Get Remotes</strong>:
<code>version_comp = "0.0.1"</code> (last upload version) 2.
<strong>Build Plan</strong>: Compare against v0.0.1 manifest -
<code>fn_add = [new_file.txt, changed_file.txt]</code> -
<code>fn_rm = [deleted_file.txt]</code> 3. <strong>Implement</strong>:
Upload 2 files, remove 1 file, update manifest</p>
</div>
<div class="section level3">
<h3 id="example-3-no-changes-skip-upload">Example 3: No Changes (Skip Upload)<a class="anchor" aria-label="anchor" href="#example-3-no-changes-skip-upload"></a>
</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> archive</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> if-change</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> sync-diff</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> manifest</span></span></code></pre></div>
<p><strong>Workflow:</strong> 1. <strong>Get Remotes</strong>:
<code>version_comp = "0.0.1"</code> 2. <strong>Build Plan</strong>:
Compare against v0.0.1 manifest - <code>fn_add = []</code>,
<code>fn_rm = []</code> (no changes) 3. <strong>Implement</strong>: Skip
upload (cue not met)</p>
</div>
<div class="section level3">
<h3 id="example-4-latest-structure-always-overwrite">Example 4: Latest Structure (Always Overwrite)<a class="anchor" aria-label="anchor" href="#example-4-latest-structure-always-overwrite"></a>
</h3>
<p><strong>Configuration:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> always</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> sync-purge</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> none</span></span></code></pre></div>
<p><strong>Workflow:</strong> 1. <strong>Get Remotes</strong>:
<code>version_comp = NULL</code> (inspect = none) 2. <strong>Build
Plan</strong>: <code>purge = true</code>,
<code>fn_add = all local files</code> 3. <strong>Implement</strong>:
Remove all remote files, upload all local files</p>
</div>
</div>
<div class="section level2">
<h2 id="trust-and-manifest-validation">Trust and Manifest Validation<a class="anchor" aria-label="anchor" href="#trust-and-manifest-validation"></a>
</h2>
<p>The workflow maintains a trust system to ensure accurate
synchronization:</p>
<p><strong>Trusted Versions</strong> (can use manifest for comparison):
- Uploaded with <code>sync-diff</code> or <code>sync-purge</code>
strategy - Has valid manifest.csv on remote - No local changes since
that version</p>
<p><strong>Untrusted Versions</strong> (must hash actual files): -
Uploaded with <code>upload-all</code> or <code>upload-missing</code>
strategy - No manifest.csv on remote - Manifest doesn’t match local
manifest for that version</p>
<p>The VERSION file tracks trust status with an asterisk:</p>
<pre><code>project: 0.0.2
output: 0.0.1*  # Asterisk means untrusted
raw-data: 0.0.1  # No asterisk means trusted</code></pre>
<p>When a version is untrusted, projr falls back to hashing actual files
(<code>inspect = "file"</code>) even when
<code>inspect = "manifest"</code> is configured.</p>
</div>
<div class="section level2">
<h2 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a>
</h2>
<p><strong>Fast Configuration</strong> (recommended default):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> archive</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> if-change</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> sync-diff</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> manifest</span></span></code></pre></div>
<p>This is fastest because: - Archives preserve version history -
<code>if-change</code> skips unchanged content - <code>sync-diff</code>
uploads only differences - <code>manifest</code> avoids downloading
files</p>
<p><strong>Simple Configuration</strong> (easier to understand):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">structure</span><span class="kw">:</span><span class="at"> latest</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">send_cue</span><span class="kw">:</span><span class="at"> always</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">send_strategy</span><span class="kw">:</span><span class="at"> upload-all</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">send_inspect</span><span class="kw">:</span><span class="at"> none</span></span></code></pre></div>
<p>This is simpler but slower: - Always uploads all files - No
comparison logic needed - No manifest dependency</p>
</div>
<div class="section level2">
<h2 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h2>
<p>Enable debug output to see workflow details:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set debug output level</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>PROJR_OUTPUT_LEVEL <span class="op">=</span> <span class="st">"debug"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run production build</span></span>
<span><span class="fu"><a href="../reference/projr_build.html">projr_build_patch</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View detailed log</span></span>
<span><span class="fu"><a href="../reference/projr_log_view.html">projr_log_view</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Debug output shows: - Remote configuration (id, structure, strategy,
inspect) - Remote existence checks - Upload plan (files to add/remove) -
File operation details - Metadata updates</p>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/send-to-remotes.html">vignette("send-to-remotes")</a></code> - User guide for
configuring remote destinations</li>
<li>
<code><a href="../articles/build-process.html">vignette("build-process")</a></code> - Complete build process
overview</li>
<li>
<code><a href="../reference/projr_yml_dest_add_github.html">?projr_yml_dest_add_github</a></code> - GitHub remote
configuration</li>
<li>
<code><a href="../reference/projr_yml_dest_add.html">?projr_yml_dest_add_local</a></code> - Local remote
configuration</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miguel Rodo. Built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> and R</p>
</div>

<div class="pkgdown-footer-right">
  <p><a href="LICENSE.html">License</a> • projr is free and open source software</p>
</div>

    </footer>
</div>





  </body>
</html>
