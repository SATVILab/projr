
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> devtools::load_all()
ℹ Loading projr
using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
gcc -std=gnu2x -I"/opt/R/4.5.2/lib/R/include" -DNDEBUG   -I/usr/local/include    -fpic  -g -O2  -c renv.c -o renv.o
gcc -std=gnu2x -shared -L/opt/R/4.5.2/lib/R/lib -L/usr/local/lib -o renv.so renv.o -L/opt/R/4.5.2/lib/R/lib -lR
> dir_test <- .test_setup_project(git = TRUE, github = FALSE, set_env_var = TRUE)
> setwd(dir_test)
> 
> # Create test content
> .create_test_content <- function(label, n_files = 3) {
+   path_dir <- projr_path_get_dir(label, safe = FALSE)
+   for (i in seq_len(n_files)) {
+     file.create(file.path(path_dir, paste0('file', i, '.txt')))
+     writeLines(paste('Content', i), file.path(path_dir, paste0('file', i, '.txt')))
+   }
+   dir.create(file.path(path_dir, 'subdir'), showWarnings = FALSE)
+   file.create(file.path(path_dir, 'subdir', 'nested.txt'))
+   writeLines('Nested content', file.path(path_dir, 'subdir', 'nested.txt'))
+   invisible(TRUE)
+ }
> 
> .create_test_content('raw-data')
> projr_init_git()
[master 4d118cd] Initial projr commit
 4 files changed, 39 insertions(+), 12 deletions(-)
> .yml_git_set_push(FALSE, TRUE, NULL)
> .yml_dest_rm_type_all('default')
> 
> # Add local destination with archive structure
> projr_yml_dest_add_local(
+   title = 'test-archive',
+   content = 'raw-data',
+   path = '_archive',
+   structure = 'archive',
+   send_cue = 'always'
+ )
> 
> # Check yml
> cat('YML content:\n')
YML content:
> cat(readLines('_projr.yml'), sep='\n')
directories:
  data-raw:
    path: _data_raw
  cache:
    path: _tmp
  output:
    path: _output
  docs:
    path: docs
build:
  git:
    commit: yes
    push: no
  local:
    test-archive:
      content: raw-data
      path: _archive
      structure: archive
      send:
        cue: always

> 
> # Build
> cat('\n\nBuilding...\n')


Building...
> projr::projr_build_patch()

── Output Build: Pre-Build Preparation ─────────────────────────────────────────
• Checking prerequisites (Git, GitHub, upstream)
• Updating documentation and version information
• Running pre-build hooks
• Committing pre-build changes to Git
[master 010feb2] Snapshot pre-build
 3 files changed, 11 insertions(+), 4 deletions(-)
✔ Pre-build preparation completed

── Output Build: Build ─────────────────────────────────────────────────────────
ℹ Using rendering engine: bookdown
Rendering book in directory '.'


processing file: reportV0.0.0-1.Rmd
1/3                  
2/3 [unnamed-chunk-1]
3/3                  
output file: reportV0.0.0-1.knit.md

/usr/bin/pandoc +RTS -K512m -RTS reportV0.0.0-1.knit.md --to html4 --from markdown+autolink_bare_uris+tex_math_single_backslash --output reportV0.0.0-1.html --lua-filter /home/runner/work/_temp/Library/bookdown/rmarkdown/lua/custom-environment.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/pagebreak.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/latex-div.lua --lua-filter /home/runner/work/_temp/Library/rmarkdown/rmarkdown/lua/anchor-sections.lua --metadata-file /tmp/RtmpHfutn6/fileb868703e94e5 --wrap preserve --standalone --section-divs --table-of-contents --toc-depth 6 --template /home/runner/work/_temp/Library/bookdown/templates/gitbook.html --highlight-style pygments --number-sections --css style.css --mathjax --include-in-header /tmp/RtmpHfutn6/rmarkdown-strb8682f380f77.html 

Output created: _tmp/projr/v0.0.1/docs/index.html
✔ Document rendering completed

── Output Build: Post-Build ────────────────────────────────────────────────────
• Finalizing build artifacts
Copied bookdown output from _tmp/projr/v0.0.1/docs to docs
• Updating documentation and metadata
• Committing post-build changes to Git
[master a145c0d] Build v0.0.1: Build project
 4 files changed, 131 insertions(+), 1 deletion(-)
 create mode 100644 BUILDLOG.md
 create mode 100644 CHANGELOG.md
 create mode 100644 manifest.csv
• Sending artifacts to remote destinations
• Running post-build hooks
• Pushing to Git remote
✔ Post-build completed successfully
> 
> # Check results
> cat('\n\nChecking results:\n')


Checking results:
> cat('Archive directory exists:', dir.exists('_archive'), '\n')
Archive directory exists: TRUE 
> cat('Archive/raw-data directory exists:', dir.exists('_archive/raw-data'), '\n')
Archive/raw-data directory exists: TRUE 
> cat('Archive structure:\n')
Archive structure:
> list.files('_archive', recursive = TRUE, all.files = TRUE)
[1] "CHANGELOG.md" "manifest.csv" "VERSION"     
> 
> 
Ran 2/2 deferred expressions
sh: 0: getcwd() failed: No such file or directory
